<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Haml::Helpers
  
    &mdash; Haml Documentation
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (H)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Haml.html" title="Haml (module)">Haml</a></span></span>
     &raquo; 
    <span class="title">Helpers</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Haml::Helpers
  
  
  
</h1>

<dl class="box">
  
  
    
      <dt class="r1">Extended by:</dt>
      <dd class="r1"><span class='object_link'><a href="" title="Haml::Helpers (module)">Helpers</a></span></dd>
      
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="Helpers/ActionViewExtensions.html" title="Haml::Helpers::ActionViewExtensions (module)">ActionViewExtensions</a></span>, XssMods</dd>
      
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="Buffer.html" title="Haml::Buffer (class)">Buffer</a></span>, <span class='object_link'><a href="" title="Haml::Helpers (module)">Helpers</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/haml/helpers.rb<span class="defines">,<br />
  lib/haml/template.rb,<br /> lib/haml/helpers/action_view_extensions.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This module contains various helpful methods to make it easier to do various tasks. <span class='object_link'><a href="" title="Haml::Helpers (module)">Helpers</a></span> is automatically included in the context that a Haml template is parsed in, so all these methods are at your disposal from within the template.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Helpers/ActionViewExtensions.html" title="Haml::Helpers::ActionViewExtensions (module)">ActionViewExtensions</a></span>
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Helpers/ErrorReturn.html" title="Haml::Helpers::ErrorReturn (class)">ErrorReturn</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  







  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#action_view%3F-class_method" title="action_view? (class method)">+ (Boolean) <strong>action_view?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Whether or not ActionView is loaded.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#block_is_haml%3F-instance_method" title="#block_is_haml? (instance method)">- (Boolean) <strong>block_is_haml?</strong>(block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether or not <code>block</code> is defined directly in a Haml template.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#capture_haml-instance_method" title="#capture_haml (instance method)">- <strong>capture_haml</strong>(*args) {|args| ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Captures the result of a block of Haml code, gets rid of the excess indentation, and returns it as a string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#escape_once-instance_method" title="#escape_once (instance method)">- (String) <strong>escape_once</strong>(text) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Escapes HTML entities in <code>text</code>, but without escaping an ampersand that is already part of an escaped entity.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_and_preserve-instance_method" title="#find_and_preserve (instance method)">- <strong>find_and_preserve</strong>(input = nil, tags = haml_buffer.options[:preserve], &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Uses <span class='object_link'><a href="#preserve-instance_method" title="Haml::Helpers#preserve (method)">#preserve</a></span> to convert any newlines inside whitespace-sensitive tags into the HTML entities for endlines.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#haml_concat-instance_method" title="#haml_concat (instance method)">- <strong>haml_concat</strong>(text = &quot;&quot;) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Outputs text directly to the Haml buffer, with the proper indentation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#haml_indent-instance_method" title="#haml_indent (instance method)">- (String) <strong>haml_indent</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The indentation string for the current line.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#haml_tag-instance_method" title="#haml_tag (instance method)">- <strong>haml_tag</strong>(name, *rest, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates an HTML tag with the given name and optionally text and attributes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#haml_tag_if-instance_method" title="#haml_tag_if (instance method)">- <strong>haml_tag_if</strong>(condition, *tag) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Conditionally wrap a block in an element.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#html_attrs-instance_method" title="#html_attrs (instance method)">- ({#to_s =&gt; String}) <strong>html_attrs</strong>(lang = 'en-US') </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a hash containing default assignments for the <code>xmlns</code>, <code>lang</code>, and <code>xml:lang</code> attributes of the <code>html</code> HTML element.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#html_escape-instance_method" title="#html_escape (instance method)">- (String) <strong>html_escape</strong>(text) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a copy of <code>text</code> with ampersands, angle brackets and quotes escaped into HTML entities.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#init_haml_helpers-instance_method" title="#init_haml_helpers (instance method)">- <strong>init_haml_helpers</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Note: this does <strong>not</strong> need to be called when using Haml helpers normally in Rails.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_haml%3F-instance_method" title="#is_haml? (instance method)">- (Boolean) <strong>is_haml?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether or not the current template is a Haml template.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#list_of-instance_method" title="#list_of (instance method)">- <strong>list_of</strong>(enum, opts = {}) {|item| ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Takes an <code>Enumerable</code> object and a block and iterates over the enum, yielding each element to a Haml block and putting the result into ??? elements.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#non_haml-instance_method" title="#non_haml (instance method)">- <strong>non_haml</strong> { ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Runs a block of code in a non-Haml context (i.e. <span class='object_link'><a href="#is_haml%3F-instance_method" title="Haml::Helpers#is_haml? (method)">#is_haml?</a></span> will return false).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#precede-instance_method" title="#precede (instance method)">- <strong>precede</strong>(str) { ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Prepends a string to the beginning of a Haml block, with no whitespace between.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#preserve-instance_method" title="#preserve (instance method)">- <strong>preserve</strong>(input = nil, &amp;block) </a>
    

    
      (also: #flatten)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Takes any string, finds all the newlines, and converts them to HTML entities so they???ll render correctly in whitespace-sensitive tags without screwing up the indentation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#succeed-instance_method" title="#succeed (instance method)">- <strong>succeed</strong>(str) { ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Appends a string to the end of a Haml block, with no whitespace between.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#surround-instance_method" title="#surround (instance method)">- <strong>surround</strong>(front, back = front) { ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Surrounds a block of Haml code with strings, with no whitespace in between.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tab_down-instance_method" title="#tab_down (instance method)">- <strong>tab_down</strong>(i = 1) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Decrements the number of tabs the buffer automatically adds to the lines of the template.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tab_up-instance_method" title="#tab_up (instance method)">- <strong>tab_up</strong>(i = 1) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Increments the number of tabs the buffer automatically adds to the lines of the template.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#with_tabs-instance_method" title="#with_tabs (instance method)">- <strong>with_tabs</strong>(i) { ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sets the number of tabs the buffer automatically adds to the lines of the template, but only for the duration of the block.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Helpers/ActionViewExtensions.html" title="Haml::Helpers::ActionViewExtensions (module)">ActionViewExtensions</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Helpers/ActionViewExtensions.html#page_class-instance_method" title="Haml::Helpers::ActionViewExtensions#page_class (method)">#page_class</a></span>, <span class='object_link'><a href="Helpers/ActionViewExtensions.html#with_raw_haml_concat-instance_method" title="Haml::Helpers::ActionViewExtensions#with_raw_haml_concat (method)">#with_raw_haml_concat</a></span></p>

  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="action_view?-class_method">
  
    + (<tt>Boolean</tt>) <strong>action_view?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns Whether or not ActionView is loaded</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Whether or not ActionView is loaded</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 52</span>

def self.action_view?
  @@action_view_defined
end</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="block_is_haml?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>block_is_haml?</strong>(block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether or not <code>block</code> is defined directly in a Haml template.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>block</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A Ruby block</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Whether or not <code>block</code> is defined directly in a Haml template</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


643
644
645</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 643</span>

def block_is_haml?(block)
  eval('!!defined?(_hamlout)', block.binding)
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="capture_haml-instance_method">
  
    - <strong>capture_haml</strong>(*args) {|args| ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Captures the result of a block of Haml code, gets rid of the excess indentation, and returns it as a string. For example, after the following,</p>

<pre class="code ruby"><code class="ruby">.foo
  - foo = capture_haml(13) do |a|
    %p= a</code></pre>

<p>the local variable <code>foo</code> would be assigned to <code>&quot;&lt;p&gt;13&lt;/p&gt;\n&quot;</code>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Arguments to pass into the block</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>args</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A block of Haml code that will be converted to a string</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p><code>args</code></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 369</span>

def capture_haml(*args, &amp;block)
  buffer = eval('if defined? _hamlout then _hamlout else nil end', block.binding) || haml_buffer
  with_haml_buffer(buffer) do
    position = haml_buffer.buffer.length

    haml_buffer.capture_position = position
    block.call(*args)

    captured = haml_buffer.buffer.slice!(position..-1)
    return captured if haml_buffer.options[:ugly]
    # Note that the &quot;reject&quot; is needed for rbx 1.2.4, which includes empty
    # strings in the returned array when splitting by /^/.
    captured = captured.split(/^/)
    captured.delete('')

    min_tabs = nil
    captured.each do |line|
      tabs = line.index(/[^ ]/) || line.length
      min_tabs ||= tabs
      min_tabs = min_tabs &gt; tabs ? tabs : min_tabs
    end

    captured.map do |line|
      line.slice(min_tabs, line.length)
    end.join
  end
ensure
  haml_buffer.capture_position = nil
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="escape_once-instance_method">
  
    - (<tt>String</tt>) <strong>escape_once</strong>(text) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Escapes HTML entities in <code>text</code>, but without escaping an ampersand that is already part of an escaped entity.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>text</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The string to sanitize</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The sanitized string</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


615
616
617
618
619</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 615</span>

def escape_once(text)
  text = text.to_s
  text.gsub!(HTML_ESCAPE_ONCE_REGEX, HTML_ESCAPE)
  text
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_and_preserve-instance_method">
  
    
      <span class="overload">- <strong>find_and_preserve</strong>(input, tags = haml_buffer.options[:preserve]) </span>
    
      <span class="overload">- <strong>find_and_preserve</strong>(tags = haml_buffer.options[:preserve]) { ... }</span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Uses <span class='object_link'><a href="#preserve-instance_method" title="Haml::Helpers#preserve (method)">#preserve</a></span> to convert any newlines inside whitespace-sensitive tags into the HTML entities for endlines.</p>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">- <strong>find_and_preserve</strong>(input, tags = haml_buffer.options[:preserve]) </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Escapes newlines within a string.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>input</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The string within which to escape newlines</p>
</div>
      
    </li>
  
</ul>


</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">- <strong>find_and_preserve</strong>(tags = haml_buffer.options[:preserve]) { ... }</span>
        <div class="docstring">
  <div class="discussion">
    
<p>Escapes newlines within a block of Haml code.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>The block within which to escape newlines</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>tags</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>haml_buffer.options[:preserve]</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Tags that should have newlines escaped</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109
110
111
112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 107</span>

def find_and_preserve(input = nil, tags = haml_buffer.options[:preserve], &amp;block)
  return find_and_preserve(capture_haml(&amp;block), input || tags) if block
  re = /&lt;(#{tags.map(&amp;Regexp.method(:escape)).join('|')})([^&gt;]*)&gt;(.*?)(&lt;\/\1&gt;)/im
  input.to_s.gsub(re) do |s|
    s =~ re # Can't rely on $1, etc. existing since Rails' SafeBuffer#gsub is incompatible
    &quot;&lt;#{$1}#{$2}&gt;#{preserve($3)}&lt;/#{$1}&gt;&quot;
  end
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="haml_concat-instance_method">
  
    - <strong>haml_concat</strong>(text = &quot;&quot;) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Outputs text directly to the Haml buffer, with the proper indentation.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>text</span>
      
      
        <span class='type'>(<tt>#to_s</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&quot;&quot;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The text to output</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


402
403
404
405
406
407
408
409</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 402</span>

def haml_concat(text = &quot;&quot;)
  unless haml_buffer.options[:ugly] || haml_indent == 0
    haml_buffer.buffer &lt;&lt; %[#{haml_indent}#{text.to_s.gsub(&quot;\n&quot;, &quot;\n#{haml_indent}&quot;)}\n]
  else
    haml_buffer.buffer &lt;&lt; &quot;#{text}\n&quot;
  end
  ErrorReturn.new(&quot;haml_concat&quot;)
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="haml_indent-instance_method">
  
    - (<tt>String</tt>) <strong>haml_indent</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The indentation string for the current line</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The indentation string for the current line</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


412
413
414</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 412</span>

def haml_indent
  '  ' * haml_buffer.tabulation
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="haml_tag-instance_method">
  
    
      <span class="overload">- <strong>haml_tag</strong>(name, *rest, attributes = {}) { ... }</span>
    
      <span class="overload">- <strong>haml_tag</strong>(name, text, *flags, attributes = {}) </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates an HTML tag with the given name and optionally text and attributes. Can take a block that will run between the opening and closing tags. If the block is a Haml block or outputs text using <span class='object_link'><a href="#haml_concat-instance_method" title="Haml::Helpers#haml_concat (method)">#haml_concat</a></span>, the text will be properly indented.</p>

<p><code>name</code> can be a string using the standard Haml class/id shorthand (e.g. ???span#foo.bar???, ???#foo???). Just like standard Haml tags, these class and id values will be merged with manually-specified attributes.</p>

<p><code>flags</code> is a list of symbol flags like those that can be put at the end of a Haml tag (<code>:/</code>, <code>:&lt;</code>, and <code>:&gt;</code>). Currently, only <code>:/</code> and <code>:&lt;</code> are supported.</p>

<p><code>haml_tag</code> outputs directly to the buffer; its return value should not be used. If you need to get the results as a string, use <span class='object_link'><a href="#capture_haml-instance_method" title="Haml::Helpers#capture_haml (method)">#capture_haml</a></span>.</p>

<p>For example,</p>

<pre class="code ruby"><code class="ruby">haml_tag :table do
  haml_tag :tr do
    haml_tag 'td.cell' do
      haml_tag :strong, &quot;strong!&quot;
      haml_concat &quot;data&quot;
    end
    haml_tag :td do
      haml_concat &quot;more_data&quot;
    end
  end
end</code></pre>

<p>outputs</p>

<pre class="code ruby"><code class="ruby">&lt;table&gt;
  &lt;tr&gt;
    &lt;td class='cell'&gt;
      &lt;strong&gt;
        strong!
      &lt;/strong&gt;
      data
    &lt;/td&gt;
    &lt;td&gt;
      more_data
    &lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;</code></pre>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">- <strong>haml_tag</strong>(name, *rest, attributes = {}) { ... }</span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>The block of Haml code within the tag</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">- <strong>haml_tag</strong>(name, text, *flags, attributes = {}) </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>text</span>
      
      
        <span class='type'>(<tt>#to_s</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The text within the tag</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>flags</span>
      
      
        <span class='type'>(<tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Haml end-of-tag flags</p>
</div>
      
    </li>
  
</ul>


</div>
      </li>
    
  </ul>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>#to_s</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The name of the tag</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 473</span>

def haml_tag(name, *rest, &amp;block)
  ret = ErrorReturn.new(&quot;haml_tag&quot;)

  text = rest.shift.to_s unless [Symbol, Hash, NilClass].any? {|t| rest.first.is_a? t}
  flags = []
  flags &lt;&lt; rest.shift while rest.first.is_a? Symbol
  attrs = (rest.shift || {})
  attrs.keys.each {|key| attrs[key.to_s] = attrs.delete(key)} unless attrs.empty?
  name, attrs = merge_name_and_attributes(name.to_s, attrs)

  attributes = Haml::Compiler.build_attributes(haml_buffer.html?,
    haml_buffer.options[:attr_wrapper],
    haml_buffer.options[:escape_attrs],
    haml_buffer.options[:hyphenate_data_attrs],
    attrs)

  if text.nil? &amp;&amp; block.nil? &amp;&amp; (haml_buffer.options[:autoclose].include?(name) || flags.include?(:/))
    haml_concat &quot;&lt;#{name}#{attributes} /&gt;&quot;
    return ret
  end

  if flags.include?(:/)
    raise Error.new(Error.message(:self_closing_content)) if text
    raise Error.new(Error.message(:illegal_nesting_self_closing)) if block
  end

  tag = &quot;&lt;#{name}#{attributes}&gt;&quot;
  if block.nil?
    text = text.to_s
    if text.include?(&quot;\n&quot;)
      haml_concat tag
      tab_up
      haml_concat text
      tab_down
      haml_concat &quot;&lt;/#{name}&gt;&quot;
    else
      tag &lt;&lt; &quot;#{text}&lt;/#{name}&gt;&quot;
      haml_concat tag
    end
    return ret
  end

  if text
    raise Error.new(Error.message(:illegal_nesting_line, name))
  end

  if flags.include?(:&lt;)
    tag &lt;&lt; &quot;#{capture_haml(&amp;block).strip}&lt;/#{name}&gt;&quot;
    haml_concat tag
    return ret
  end

  haml_concat tag
  tab_up
  block.call
  tab_down
  haml_concat &quot;&lt;/#{name}&gt;&quot;

  ret
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="haml_tag_if-instance_method">
  
    - <strong>haml_tag_if</strong>(condition, *tag) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Conditionally wrap a block in an element. If <code>condition</code> is <code>true</code> then this method renders the tag described by the argumants in <code>tag</code> (using <span class='object_link'><a href="#haml_tag-instance_method" title="Haml::Helpers#haml_tag (method)">#haml_tag</a></span>) with the given block inside, otherwise it just renders the block.</p>

<p>For example,</p>

<pre class="code ruby"><code class="ruby">- haml_tag_if important, '.important' do
  %p
    A (possibly) important paragraph.</code></pre>

<p>will produce</p>

<pre class="code ruby"><code class="ruby">&lt;div class='important'&gt;
  &lt;p&gt;
    A (possibly) important paragraph.
  &lt;/p&gt;
&lt;/div&gt;</code></pre>

<p>if <code>important</code> is truthy, and just</p>

<pre class="code ruby"><code class="ruby">&lt;p&gt;
  A (possibly) important paragraph.
&lt;/p&gt;</code></pre>

<p>otherwise.</p>

<p>Like <span class='object_link'><a href="#haml_tag-instance_method" title="Haml::Helpers#haml_tag (method)">#haml_tag</a></span>, <code>haml_tag_if</code> outputs directly to the buffer and its return value should not be used. Use <span class='object_link'><a href="#capture_haml-instance_method" title="Haml::Helpers#capture_haml (method)">#capture_haml</a></span> if you need to use its results as a string.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>condition</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The condition to test to determine whether to render the enclosing tag</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>tag</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Definition of the enclosing tag. See <span class='object_link'><a href="#haml_tag-instance_method" title="Haml::Helpers#haml_tag (method)">#haml_tag</a></span> for details (specifically the form that takes a block)</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


568
569
570
571
572
573
574
575</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 568</span>

def haml_tag_if(condition, *tag)
  if condition
    haml_tag(*tag){ yield }
  else
    yield
  end
  ErrorReturn.new(&quot;haml_tag_if&quot;)
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="html_attrs-instance_method">
  
    - (<tt>{#to_s =&gt; String}</tt>) <strong>html_attrs</strong>(lang = 'en-US') 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a hash containing default assignments for the <code>xmlns</code>, <code>lang</code>, and <code>xml:lang</code> attributes of the <code>html</code> HTML element. For example,</p>

<pre class="code ruby"><code class="ruby">%html{html_attrs}</code></pre>

<p>becomes</p>

<pre class="code ruby"><code class="ruby">&lt;html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en-US' lang='en-US'&gt;</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>lang</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>'en-US'</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The value of <code>xml:lang</code> and <code>lang</code></p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>{#to_s =&gt; String}</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The attribute hash</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


224
225
226
227
228
229
230</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 224</span>

def html_attrs(lang = 'en-US')
  if haml_buffer.options[:format] == :xhtml
    {:xmlns =&gt; &quot;http://www.w3.org/1999/xhtml&quot;, 'xml:lang' =&gt; lang, :lang =&gt; lang}
  else
    {:lang =&gt; lang}
  end
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="html_escape-instance_method">
  
    - (<tt>String</tt>) <strong>html_escape</strong>(text) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a copy of <code>text</code> with ampersands, angle brackets and quotes escaped into HTML entities.</p>

<p>Note that if ActionView is loaded and XSS protection is enabled (as is the default for Rails 3.0+, and optional for version 2.3.5+), this won???t escape text declared as ???safe???.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>text</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The string to sanitize</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The sanitized string</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


594
595
596
597</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 594</span>

def html_escape(text)
  text = text.to_s
  text.gsub(HTML_ESCAPE_REGEX, HTML_ESCAPE)
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="init_haml_helpers-instance_method">
  
    - <strong>init_haml_helpers</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>normally in Rails.</p>

<p>Initializes the current object as though it were in the same context as a normal ActionView instance using Haml. This is useful if you want to use the helpers in a context other than the normal setup with ActionView. For example:</p>

<pre class="code ruby"><code class="ruby">context = Object.new
class &lt;&lt; context
  include Haml::Helpers
end
context.init_haml_helpers
context.haml_tag :p, &quot;Stuff&quot;</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74
75</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 72</span>

def init_haml_helpers
  @haml_buffer = Haml::Buffer.new(haml_buffer, Options.new.for_buffer)
  nil
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="is_haml?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>is_haml?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether or not the current template is a Haml template.</p>

<p>This function, unlike other <span class='object_link'><a href="" title="Haml::Helpers (module)">Haml::Helpers</a></span> functions, also works in other <code>ActionView</code> templates, where it will always return false.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Whether or not the current template is a Haml template</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


635
636
637</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 635</span>

def is_haml?
  !@haml_buffer.nil? &amp;&amp; @haml_buffer.active?
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="list_of-instance_method">
  
    - <strong>list_of</strong>(enum, opts = {}) {|item| ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Takes an <code>Enumerable</code> object and a block and iterates over the enum, yielding each element to a Haml block and putting the result into <code>&lt;li&gt;</code> elements. This creates a list of the results of the block. For example:</p>

<pre class="code ruby"><code class="ruby">= list_of([['hello'], ['yall']]) do |i|
  = i[0]</code></pre>

<p>Produces:</p>

<pre class="code ruby"><code class="ruby">&lt;li&gt;hello&lt;/li&gt;
&lt;li&gt;yall&lt;/li&gt;</code></pre>

<p>And:</p>

<pre class="code ruby"><code class="ruby">= list_of({:title =&gt; 'All the stuff', :description =&gt; 'A book about all the stuff.'}) do |key, val|
  %h3= key.humanize
  %p= val</code></pre>

<p>Produces:</p>

<pre class="code ruby"><code class="ruby">&lt;li&gt;
  &lt;h3&gt;Title&lt;/h3&gt;
  &lt;p&gt;All the stuff&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
  &lt;h3&gt;Description&lt;/h3&gt;
  &lt;p&gt;A book about all the stuff.&lt;/p&gt;
&lt;/li&gt;</code></pre>

<p>While:</p>

<pre class="code ruby"><code class="ruby">= list_of([&quot;Home&quot;, &quot;About&quot;, &quot;Contact&quot;, &quot;FAQ&quot;], {class: &quot;nav&quot;, role: &quot;nav&quot;}) do |item|
  %a{ href=&quot;#&quot; }= item</code></pre>

<p>Produces:</p>

<pre class="code ruby"><code class="ruby">&lt;li class='nav' role='nav'&gt;
  &lt;a href='#'&gt;Home&lt;/a&gt;
&lt;/li&gt;
&lt;li class='nav' role='nav'&gt;
  &lt;a href='#'&gt;About&lt;/a&gt;
&lt;/li&gt;
&lt;li class='nav' role='nav'&gt;
  &lt;a href='#'&gt;Contact&lt;/a&gt;
&lt;/li&gt;
&lt;li class='nav' role='nav'&gt;
  &lt;a href='#'&gt;FAQ&lt;/a&gt;
&lt;/li&gt;</code></pre>

<p><code>[[class&quot;, &quot;nav&quot;], [role&quot;, &quot;nav&quot;]]</code> could have been used instead of <code>{class: &quot;nav&quot;, role: &quot;nav&quot;}</code> (or any enumerable collection where each pair of items responds to #to_s)</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>enum</span>
      
      
        <span class='type'>(<tt>Enumerable</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The list of objects to iterate over</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Enumerable&lt;#to_s,#to_s&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Each key/value pair will become an attribute pair for each list item element.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>item</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A block which contains Haml code that goes within list items</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>item</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An element of <code>enum</code></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 195</span>

def list_of(enum, opts={}, &amp;block)
  opts_attributes = opts.empty? ? &quot;&quot; : &quot; &quot;.&lt;&lt;(opts.map{|k,v| &quot;#{k}='#{v}'&quot; }.join(&quot; &quot;))
  to_return = enum.collect do |i|
    result = capture_haml(i, &amp;block)

    if result.count(&quot;\n&quot;) &gt; 1
      result.gsub!(&quot;\n&quot;, &quot;\n  &quot;)
      result = &quot;\n  #{result.strip}\n&quot;
    else
      result = result.strip
    end

    %Q!&lt;li#{opts_attributes}&gt;#{result}&lt;/li&gt;!
  end
  to_return.join(&quot;\n&quot;)
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="non_haml-instance_method">
  
    - <strong>non_haml</strong> { ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Runs a block of code in a non-Haml context (i.e. <span class='object_link'><a href="#is_haml%3F-instance_method" title="Haml::Helpers#is_haml? (method)">#is_haml?</a></span> will return false).</p>

<p>This is mainly useful for rendering sub-templates such as partials in a non-Haml language, particularly where helpers may behave differently when run from Haml.</p>

<p>Note that this is automatically applied to Rails partials.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>A block which won’t register as Haml</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88
89
90
91
92</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 86</span>

def non_haml
  was_active = @haml_buffer.active?
  @haml_buffer.active = false
  yield
ensure
  @haml_buffer.active = was_active
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="precede-instance_method">
  
    - <strong>precede</strong>(str) { ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Prepends a string to the beginning of a Haml block, with no whitespace between. For example:</p>

<pre class="code ruby"><code class="ruby">= precede '*' do
  %span.small Not really</code></pre>

<p>Produces:</p>

<pre class="code ruby"><code class="ruby">*&lt;span class='small'&gt;Not really&lt;/span&gt;</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>str</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The string to add before the Haml</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>A block of Haml to prepend to</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 332</span>

def precede(str, &amp;block)
  &quot;#{str}#{capture_haml(&amp;block).chomp}\n&quot;
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="preserve-instance_method">
  
    
      <span class="overload">- <strong>preserve</strong>(input) </span>
    
      <span class="overload">- <strong>preserve</strong> { ... }</span>
    
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='flatten-instance_method'>flatten</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Takes any string, finds all the newlines, and converts them to HTML entities so they???ll render correctly in whitespace-sensitive tags without screwing up the indentation.</p>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">- <strong>preserve</strong>(input) </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Escapes newlines within a string.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>input</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The string within which to escape all newlines</p>
</div>
      
    </li>
  
</ul>


</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">- <strong>preserve</strong> { ... }</span>
        <div class="docstring">
  <div class="discussion">
    
<p>Escapes newlines within a block of Haml code.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>The block within which to escape newlines</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


128
129
130
131
132
133
134</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 128</span>

def preserve(input = nil, &amp;block)
  return preserve(capture_haml(&amp;block)) if block
  s = input.to_s.chomp(&quot;\n&quot;)
  s.gsub!(/\n/, '&amp;#x000A;')
  s.delete!(&quot;\r&quot;)
  s
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="succeed-instance_method">
  
    - <strong>succeed</strong>(str) { ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Appends a string to the end of a Haml block, with no whitespace between. For example:</p>

<pre class="code ruby"><code class="ruby">click
= succeed '.' do
  %a{:href=&gt;&quot;thing&quot;} here</code></pre>

<p>Produces:</p>

<pre class="code ruby"><code class="ruby">click
&lt;a href='thing'&gt;here&lt;/a&gt;.</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>str</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The string to add after the Haml</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>A block of Haml to append to</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


351
352
353</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 351</span>

def succeed(str, &amp;block)
  &quot;#{capture_haml(&amp;block).chomp}#{str}\n&quot;
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="surround-instance_method">
  
    - <strong>surround</strong>(front, back = front) { ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Surrounds a block of Haml code with strings, with no whitespace in between. For example:</p>

<pre class="code ruby"><code class="ruby">= surround '(', ')' do
  %a{:href =&gt; &quot;food&quot;} chicken</code></pre>

<p>Produces:</p>

<pre class="code ruby"><code class="ruby">(&lt;a href='food'&gt;chicken&lt;/a&gt;)</code></pre>

<p>and</p>

<pre class="code ruby"><code class="ruby">= surround '*' do
  %strong angry</code></pre>

<p>Produces:</p>

<pre class="code ruby"><code class="ruby">*&lt;strong&gt;angry&lt;/strong&gt;*</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>front</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The string to add before the Haml</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>back</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>front</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The string to add after the Haml</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>A block of Haml to surround</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


313
314
315
316
317</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 313</span>

def surround(front, back = front, &amp;block)
  output = capture_haml(&amp;block)

  &quot;#{front}#{output.chomp}#{back}\n&quot;
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tab_down-instance_method">
  
    - <strong>tab_down</strong>(i = 1) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Decrements the number of tabs the buffer automatically adds to the lines of the template.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>i</span>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>1</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The number of tabs by which to decrease the indentation</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#tab_up-instance_method" title="Haml::Helpers#tab_up (method)">#tab_up</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


259
260
261</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 259</span>

def tab_down(i = 1)
  haml_buffer.tabulation -= i
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tab_up-instance_method">
  
    - <strong>tab_up</strong>(i = 1) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Increments the number of tabs the buffer automatically adds to the lines of the template. For example:</p>

<pre class="code ruby"><code class="ruby">%h1 foo
- tab_up
%p bar
- tab_down
%strong baz</code></pre>

<p>Produces:</p>

<pre class="code ruby"><code class="ruby">&lt;h1&gt;foo&lt;/h1&gt;
  &lt;p&gt;bar&lt;/p&gt;
&lt;strong&gt;baz&lt;/strong&gt;</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>i</span>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>1</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The number of tabs by which to increase the indentation</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#tab_down-instance_method" title="Haml::Helpers#tab_down (method)">#tab_down</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


250
251
252</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 250</span>

def tab_up(i = 1)
  haml_buffer.tabulation += i
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="with_tabs-instance_method">
  
    - <strong>with_tabs</strong>(i) { ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sets the number of tabs the buffer automatically adds to the lines of the template, but only for the duration of the block. For example:</p>

<pre class="code ruby"><code class="ruby">%h1 foo
- with_tabs(2) do
  %p bar
%strong baz</code></pre>

<p>Produces:</p>

<pre class="code ruby"><code class="ruby">&lt;h1&gt;foo&lt;/h1&gt;
    &lt;p&gt;bar&lt;/p&gt;
&lt;strong&gt;baz&lt;/strong&gt;</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>i</span>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of tabs to use</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>A block in which the indentation will be <code>i</code> spaces</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


282
283
284
285
286
287
288</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/helpers.rb', line 282</span>

def with_tabs(i)
  old_tabs = haml_buffer.tabulation
  haml_buffer.tabulation = i
  yield
ensure
  haml_buffer.tabulation = old_tabs
end</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Tue Oct 15 21:09:23 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.2 (ruby-1.9.3).
</div>



  </body>
</html>